<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PocketBeagle 2 Pin Configurator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            font-weight: bold;
        }

        .pin-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            margin-bottom: 0.5rem;
            width: 55%;
            font-size: 11px;
            font-weight: bold;
        }

        .pin-pair-container {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            align-items: flex-end;
        }

        .pin-pair-container.right {
            align-items: flex-start;
        }

        .pin-row-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 12px;
            font-weight: bold;
        }

        .pin-row-item .label {
            font-weight: 600;
            width: 4rem;
            text-align: right;
        }
        
        .pin-pair-container.right .pin-row-item .label {
            text-align: left;
        }

        .pin-row-item select, .pin-row-item .fixed-func {
            border: 2px solid #d1d5db;
            border-radius: 0.5rem;
            padding: 0.25rem 0.5rem;
            font-size: 11px;
            width: 10rem;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        .pin-row-item select {
            cursor: pointer;
        }

        /* Styling for Fixed-Function Pins */
        .fixed-func.gnd {
            background-color: #000;
            color: #fff;
        }

        .fixed-func.vin {
            background-color: #7fffd4; /* Aquamarine */
            color: #000;
        }
        
        .fixed-func.vout {
            background-color: #ef4444; /* Red */
            color: #000;
        }

        .pin-row-item .fixed-func {
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: bold;
        }

        .pin-row-item select:focus {
            outline: none;
            border-color: #3b82f6;
            font-size: 100%;
            font-weight: bold;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
        }

        .pin-status {
            width: 0.6rem;
            height: 0.6rem;
            border-radius: 50%;
            font-weight: bold;
        }

        .status-idle { background-color: #d1d5db; }
        .status-used { background-color: #3b82f6; }
        .status-conflict { background-color: #ef4444; }

        .tooltip-container {
            position: relative;
        }

        .tooltip {
            position: absolute;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: #fff;
            padding: 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }

        .tooltip-container:hover .tooltip {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100 p-8">

    <div class="container bg-white p-8 rounded-2xl shadow-xl">
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">PocketBeagle 2 Pin Configurator</h1>
        <p class="text-center text-gray-600 mb-8">Select a function for each pin from the dropdowns. Conflicts will be highlighted automatically.</p>
        
        <div class="flex flex-col md:flex-row justify-center items-center gap-8 md:gap-16">
            <!-- Left Side Pins (P1 Header) -->
            <div id="p1-pins" class="flex flex-col items-end flex-grow">
            </div>

            <!-- Board Image -->
            <div class="flex-shrink-0">
                <img src="https://placehold.co/300x400/94a3b8/e2e8f0?text=PocketBeagle+2" alt="PocketBeagle 2 Board" class="rounded-xl shadow-lg border-2 border-gray-300">
            </div>

            <!-- Right Side Pins (P2 Header) -->
            <div id="p2-pins" class="flex flex-col items-start flex-grow">
            </div>
        </div>

        <!-- Export and Legend -->
        <div class="mt-8 pt-6 border-t border-gray-200 flex flex-col items-center space-y-4">
            <button id="export-dts-btn" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-300">
                Export .dts File
            </button>
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <span class="pin-status status-used"></span>
                    <span class="text-gray-600">Selected Pin</span>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="pin-status status-conflict"></span>
                    <span class="text-gray-600">Conflicted Pin</span>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="pin-status status-idle"></span>
                    <span class="text-gray-600">Available Pin</span>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-4 text-center">Note: This is a representative tool. Always consult the official documentation for full pin configurations and multiplexing options.</p>
        </div>
    </div>

    <script>
        // Data model for all pins, their available functions, and corresponding DTS hex codes.
        const pinDefinitions = {
            // P1 Header Pins (left side)
            'P1_01': { fixed: 'GND', type: 'gnd' },
            'P1_02': { fixed: 'GND', type: 'gnd' },
            'P1_03': { fixed: 'VOUT-5V', type: 'vout' },
            'P1_04': { fixed: 'VIN-5V', type: 'vin' },
            'P1_05': { fixed: 'VIN-BAT', type: 'vin' },
            'P1_06': { fixed: 'BAT-TEMP', type: 'vin' },
            'P1_07': { fixed: 'GND', type: 'gnd' },
            'P1_08': { fixed: 'GND', type: 'gnd' },
            'P1_09': { fixed: 'GND', type: 'gnd' },
            'P1_10': { fixed: 'VOUT-3.3V', type: 'vout' },
            'P1_11': { fixed: 'VOUT-3.3V', type: 'vout' },
            'P1_12': { fixed: 'GND', type: 'gnd' },
            'P1_13': { fixed: 'GND', type: 'gnd' },
            'P1_14': { fixed: 'GND', type: 'gnd' },
            'P1_15': { fixed: 'GND', type: 'gnd' },
            'P1_16': { fixed: 'GND', type: 'gnd' },
            'P1_17': {
                dtsPin: 'gpio0_53',
                options: {
                    'USB0_DP': '0x000', 'GPIO0_53': '0x007', 'PRU1_PRU_R31_0': '0x004', 'PWM_A': '0x006'
                }
            },
            'P1_18': {
                dtsPin: 'gpio0_54',
                options: {
                    'USB0_DM': '0x000', 'GPIO0_54': '0x007', 'PRU1_PRU_R31_1': '0x004', 'PWM_B': '0x006'
                }
            },
            'P1_19': {
                dtsPin: 'gpio1_14',
                options: {
                    'UART1_RXD': '0x002', 'GPIO1_14': '0x007', 'I2C2_SDA': '0x000'
                }
            },
            'P1_20': {
                dtsPin: 'gpio1_15',
                options: {
                    'UART1_TXD': '0x002', 'GPIO1_15': '0x007', 'I2C2_SCL': '0x000'
                }
            },
            'P1_21': {
                dtsPin: 'gpio1_16',
                options: {
                    'SPI0_CS0': '0x001', 'GPIO1_16': '0x007', 'PRU1_PRU_R31_2': '0x004', 'PWM_A': '0x006'
                }
            },
            'P1_22': {
                dtsPin: 'gpio1_17',
                options: {
                    'SPI0_CS1': '0x001', 'GPIO1_17': '0x007', 'PRU1_PRU_R31_3': '0x004', 'PWM_B': '0x006'
                }
            },
            'P1_23': {
                dtsPin: 'gpio1_18',
                options: {
                    'SPI0_D0': '0x001', 'GPIO1_18': '0x007', 'PWM_A': '0x006'
                }
            },
            'P1_24': {
                dtsPin: 'gpio1_19',
                options: {
                    'SPI0_CLK': '0x001', 'GPIO1_19': '0x007', 'PWM_B': '0x006'
                }
            },
            'P1_25': {
                dtsPin: 'gpio1_20',
                options: {
                    'PWM_A': '0x006', 'GPIO1_20': '0x007', 'I2C_SDA': '0x001'
                }
            },
            'P1_26': {
                dtsPin: 'gpio1_21',
                options: {
                    'PWM_B': '0x006', 'GPIO1_21': '0x007', 'I2C_SCL': '0x001'
                }
            },
            'P1_27': { dtsPin: 'gpio1_22', options: { 'PRU1_R31_4': '0x004', 'GPIO1_22': '0x007' } },
            'P1_28': { dtsPin: 'gpio1_23', options: { 'PRU1_R31_5': '0x004', 'GPIO1_23': '0x007' } },
            'P1_29': { dtsPin: 'gpio1_24', options: { 'UART3_RXD': '0x002', 'GPIO1_24': '0x007' } },
            'P1_30': { dtsPin: 'gpio1_25', options: { 'UART3_TXD': '0x002', 'GPIO1_25': '0x007' } },
            'P1_31': { dtsPin: 'gpio1_26', options: { 'CAN1_TX': '0x001', 'GPIO1_26': '0x007' } },
            'P1_32': { dtsPin: 'gpio1_27', options: { 'CAN1_RX': '0x001', 'GPIO1_27': '0x007' } },
            'P1_33': { dtsPin: 'gpio1_28', options: { 'GPIO1_28': '0x007' } },
            'P1_34': { dtsPin: 'gpio1_29', options: { 'GPIO1_29': '0x007' } },
            'P1_35': { dtsPin: 'gpio1_30', options: { 'GPIO1_30': '0x007' } },
            'P1_36': { dtsPin: 'gpio1_31', options: { 'GPIO1_31': '0x007' } },
            
            // P2 Header Pins (right side)
            'P2_01': { fixed: 'GND', type: 'gnd' },
            'P2_02': { fixed: 'GND', type: 'gnd' },
            'P2_03': { fixed: 'VOUT-5V', type: 'vout' },
            'P2_04': { fixed: 'VOUT-5V', type: 'vout' },
            'P2_05': { fixed: 'GND', type: 'gnd' },
            'P2_06': { fixed: 'GND', type: 'gnd' },
            'P2_07': { fixed: 'GND', type: 'gnd' },
            'P2_08': { fixed: 'GND', type: 'gnd' },
            'P2_09': { fixed: 'GND', type: 'gnd' },
            'P2_10': { fixed: 'VOUT-3.3V', type: 'vout' },
            'P2_11': { fixed: 'VOUT-3.3V', type: 'vout' },
            'P2_12': { fixed: 'GND', type: 'gnd' },
            'P2_13': { fixed: 'GND', type: 'gnd' },
            'P2_14': { fixed: 'GND', type: 'gnd' },
            'P2_15': { fixed: 'GND', type: 'gnd' },
            'P2_16': { fixed: 'GND', type: 'gnd' },
            'P2_17': { dtsPin: 'ain0', options: { 'ADC': '0x007', 'AIN0': '0x007' } },
            'P2_18': { dtsPin: 'ain1', options: { 'ADC': '0x007', 'AIN1': '0x007' } },
            'P2_19': { dtsPin: 'ain2', options: { 'ADC': '0x007', 'AIN2': '0x007' } },
            'P2_20': { dtsPin: 'ain3', options: { 'ADC': '0x007', 'AIN3': '0x007' } },
            'P2_21': { dtsPin: 'ain4', options: { 'ADC': '0x007', 'AIN4': '0x007' } },
            'P2_22': { dtsPin: 'ain5', options: { 'ADC': '0x007', 'AIN5': '0x007' } },
            'P2_23': { dtsPin: 'ain6', options: { 'ADC': '0x007', 'AIN6': '0x007' } },
            'P2_24': { dtsPin: 'ain7', options: { 'ADC': '0x007', 'AIN7': '0x007' } },
            'P2_25': { dtsPin: 'gpio1_08', options: { 'UART2_RXD': '0x002', 'GPIO1_08': '0x007', 'I2C_SDA': '0x001' } },
            'P2_26': { dtsPin: 'gpio1_09', options: { 'UART2_TXD': '0x002', 'GPIO1_09': '0x007', 'I2C_SCL': '0x001' } },
            'P2_27': { dtsPin: 'gpio1_10', options: { 'SPI1_CS0': '0x001', 'GPIO1_10': '0x007', 'PWM_A': '0x006' } },
            'P2_28': { dtsPin: 'gpio1_11', options: { 'SPI1_CS1': '0x001', 'GPIO1_11': '0x007', 'PWM_B': '0x006' } },
            'P2_29': { dtsPin: 'gpio1_12', options: { 'SPI1_D0': '0x001', 'GPIO1_12': '0x007', 'PWM_A': '0x006' } },
            'P2_30': { dtsPin: 'gpio1_13', options: { 'SPI1_CLK': '0x001', 'GPIO1_13': '0x007', 'PWM_B': '0x006' } },
            'P2_31': { dtsPin: 'gpio1_00', options: { 'PRU0_R31_0': '0x004', 'GPIO1_00': '0x007' } },
            'P2_32': { dtsPin: 'gpio1_01', options: { 'PRU0_R31_1': '0x004', 'GPIO1_01': '0x007' } },
            'P2_33': { dtsPin: 'gpio1_02', options: { 'PRU0_R31_2': '0x004', 'GPIO1_02': '0x007' } },
            'P2_34': { dtsPin: 'gpio1_03', options: { 'PRU0_R31_3': '0x004', 'GPIO1_03': '0x007' } },
            'P2_35': { dtsPin: 'gpio1_04', options: { 'CAN0_TX': '0x001', 'GPIO1_04': '0x007' } },
            'P2_36': { dtsPin: 'gpio1_05', options: { 'CAN0_RX': '0x001', 'GPIO1_05': '0x007' } },
        };

        // Bus definitions for group selection
        const busDefinitions = {
            'SPI0': ['SPI0_CS0', 'SPI0_CS1', 'SPI0_D0', 'SPI0_CLK'],
            'SPI1': ['SPI1_CS0', 'SPI1_CS1', 'SPI1_D0', 'SPI1_CLK'],
            'I2C2': ['I2C2_SDA', 'I2C2_SCL'],
            'UART1': ['UART1_RXD', 'UART1_TXD'],
            'UART2': ['UART2_RXD', 'UART2_TXD'],
            'UART3': ['UART3_RXD', 'UART3_TXD'],
            'CAN0': ['CAN0_TX', 'CAN0_RX'],
            'CAN1': ['CAN1_TX', 'CAN1_RX'],
            'PRU0_R31': ['PRU0_R31_0', 'PRU0_R31_1', 'PRU0_R31_2', 'PRU0_R31_3'],
            'PRU1_R31': ['PRU1_R31_0', 'PRU1_R31_1', 'PRU1_R31_2', 'PRU1_R31_3', 'PRU1_R31_4', 'PRU1_R31_5'],
            'PWM': ['PWM_A', 'PWM_B'],
            'ADC': ['ADC', 'AIN0', 'AIN1', 'AIN2', 'AIN3', 'AIN4', 'AIN5', 'AIN6', 'AIN7']
        };

        // State to track current pin assignments and conflicts
        let pinAssignments = {};
        let conflictedPins = new Set();
        let selectedFunctions = {};

        // Function to create a single pin row item (label, dropdown/text, status)
        function createPinItem(pin, side) {
            const pinConfig = pinDefinitions[pin];
            const itemDiv = document.createElement('div');
            itemDiv.className = 'pin-row-item ' + (side === 'left' ? 'flex-row-reverse' : '');

            const labelSpan = document.createElement('span');
            labelSpan.textContent = pin.replace('_', ' ');
            labelSpan.className = 'label';

            const statusSpan = document.createElement('span');
            statusSpan.id = `status-${pin}`;
            statusSpan.className = 'pin-status status-idle';

            if (pinConfig.fixed) {
                const fixedFunc = document.createElement('span');
                fixedFunc.className = `fixed-func ${pinConfig.type}`;
                fixedFunc.textContent = pinConfig.fixed;
                if (side === 'left') {
                    itemDiv.append(fixedFunc, statusSpan, labelSpan);
                } else {
                    itemDiv.append(fixedFunc, statusSpan, labelSpan);
                }
            } else {
                const selectEl = document.createElement('select');
                selectEl.id = `select-${pin}`;
                selectEl.className = 'select-pin';

                const defaultOption = document.createElement('option');
                defaultOption.value = 'none';
                defaultOption.textContent = '-- Unassigned --';
                selectEl.appendChild(defaultOption);

                Object.keys(pinConfig.options).forEach(func => {
                    const option = document.createElement('option');
                    option.style = 'font-weight: 600;';
                    option.value = func;
                    option.textContent = func;
                    selectEl.appendChild(option);
                });

                selectEl.addEventListener('change', () => handlePinChange(pin));
                if (side === 'left') {
                    itemDiv.append(selectEl, statusSpan, labelSpan);
                } else {
                    itemDiv.append(selectEl, statusSpan, labelSpan);
                }
            }

            return itemDiv;
        }

        // Function to render all pin elements
        function renderPins() {
            const p1Container = document.getElementById('p1-pins');
            const p2Container = document.getElementById('p2-pins');
            
            p1Container.innerHTML = '';
            p2Container.innerHTML = '';

            const p1Pins = Object.keys(pinDefinitions).filter(pin => pin.startsWith('P1_')).sort((a, b) => parseInt(a.split('_')[1]) - parseInt(b.split('_')[1]));
            const p2Pins = Object.keys(pinDefinitions).filter(pin => pin.startsWith('P2_')).sort((a, b) => parseInt(a.split('_')[1]) - parseInt(b.split('_')[1]));
            
            // Render P1 pins
            for (let i = 0; i < p1Pins.length; i += 2) {
                const outerPin = p1Pins[i];
                const innerPin = p1Pins[i + 1];

                const rowDiv = document.createElement('div');
                rowDiv.className = 'pin-row w-full';
                rowDiv.style = 'width: 70%;'

                const innerPinItem = createPinItem(innerPin, 'left');
                const outerPinItem = createPinItem(outerPin, 'left');
                
                rowDiv.append(innerPinItem, outerPinItem);
                p1Container.appendChild(rowDiv);
            }

            // Render P2 pins
            for (let i = 0; i < p2Pins.length; i += 2) {
                const outerPin = p2Pins[i];
                const innerPin = p2Pins[i + 1];

                const rowDiv = document.createElement('div');
                rowDiv.className = 'pin-row w-full';
                rowDiv.style = 'width: 55%; font-size: 10%; font-weight: bold;'

                const outerPinItem = createPinItem(outerPin, 'right');
                const innerPinItem = createPinItem(innerPin, 'right');

                rowDiv.append(outerPinItem, innerPinItem);
                p2Container.appendChild(rowDiv);
            }

            updateUI();
        }

        // Handles pin change events and updates UI
        function handlePinChange(pin) {
            const selectEl = document.getElementById(`select-${pin}`);
            const newFunction = selectEl.value;
            const oldFunction = pinAssignments[pin] || 'none';
            
            // Remove old assignment if any
            if (pinAssignments[pin]) {
                delete pinAssignments[pin];
                if (selectedFunctions[oldFunction] === pin) {
                    delete selectedFunctions[oldFunction];
                }
            }

            // Add new assignment if not 'none'
            if (newFunction !== 'none') {
                pinAssignments[pin] = newFunction;
                selectedFunctions[newFunction] = pin;
            }

            // Check if the new function is part of a bus and update all pins on that bus
            for (const bus in busDefinitions) {
                if (busDefinitions[bus].includes(newFunction)) {
                    busDefinitions[bus].forEach(busFunction => {
                        const busPin = findPinByFunction(busFunction);
                        if (busPin && busPin !== pin) {
                            const busPinSelect = document.getElementById(`select-${busPin}`);
                            if (busPinSelect && busPinSelect.value !== busFunction) {
                                busPinSelect.value = busFunction;
                                pinAssignments[busPin] = busFunction;
                                selectedFunctions[busFunction] = busPin;
                            }
                        }
                    });
                }
            }
            
            checkConflicts();
            updateUI();
        }

        // Helper function to find a pin by its assigned function
        function findPinByFunction(func) {
            for (const pin in pinDefinitions) {
                if (pinDefinitions[pin].options && pinDefinitions[pin].options[func]) {
                    return pin;
                }
            }
            return null;
        }

        // Check for conflicts where the same function is assigned to multiple pins
        function checkConflicts() {
            conflictedPins.clear();
            const assignments = Object.values(pinAssignments);
            const counts = {};

            // Count occurrences of each function
            assignments.forEach(func => {
                counts[func] = (counts[func] || 0) + 1;
            });
            
            // Find functions with more than one assignment
            const conflictedFunctions = Object.keys(counts).filter(func => counts[func] > 1);
            
            // Find pins that are assigned to a conflicted function
            Object.keys(pinAssignments).forEach(pin => {
                if (conflictedFunctions.includes(pinAssignments[pin])) {
                    conflictedPins.add(pin);
                }
            });
        }

        // Update the visual status of all pins
        function updateUI() {
            Object.keys(pinDefinitions).forEach(pin => {
                const selectEl = document.getElementById(`select-${pin}`);
                const statusEl = document.getElementById(`status-${pin}`);
                
                if (!statusEl) return;
                
                // Reset to default
                if (selectEl) {
                    selectEl.classList.remove('border-red-500');
                }
                statusEl.className = 'pin-status status-idle';
                
                // Apply conflict class if needed
                if (conflictedPins.has(pin)) {
                    statusEl.classList.add('status-conflict');
                    if (selectEl) {
                        selectEl.classList.add('border-red-500');
                    }
                } else if (pinAssignments[pin]) {
                    statusEl.classList.add('status-used');
                }

                // Disable options that are already in use on another pin
                if (selectEl) {
                    const currentSelection = pinAssignments[pin] || 'none';
                    Array.from(selectEl.options).forEach(option => {
                        if (option.value !== 'none' && option.value !== currentSelection) {
                            if (selectedFunctions[option.value]) {
                                option.disabled = true;
                                option.classList.add('text-gray-400');
                                option.style.add('font-weight: bold;');
                            } else {
                                option.disabled = false;
                                option.classList.remove('text-gray-400');
                                option.style.add('font-weight: bold;');
                            }
                        }
                    });
                }
            });
        }

        // Function to generate the DTS content
        function generateDTS() {
            let dtsContent = `/*
 * Device Tree Overlay for PocketBeagle 2
 * Generated by the Pin Configurator App
 */

/dts-v1/;
/plugin/;

/ {
    compatible = "ti,am62a-pocketbeagle-2";

    fragment@0 {
        target = <&iomuxc>;
        __overlay__ {
            pinctrl-pocketbeagle2-pins {
                pinctrl-single,pins = <`;
            
            const sortedPins = Object.keys(pinAssignments).sort();
            
            if (sortedPins.length > 0) {
                dtsContent += `\n`;
                sortedPins.forEach(pin => {
                    const func = pinAssignments[pin];
                    const pinConfig = pinDefinitions[pin];
                    if (pinConfig && pinConfig.options && pinConfig.options[func]) {
                        dtsContent += `\t\t\t\t\t<${pinConfig.dtsPin} ${pinConfig.options[func]}> /* ${pin} -> ${func} */\n`;
                    }
                });
                dtsContent += `\t\t\t\t>;\n`;
            } else {
                dtsContent += `\n\t\t\t\t>;\n`;
            }
            dtsContent += `\t\t\t};\n`;
            
            // Add stubs for peripherals if required (e.g., if a UART is selected)
            // This is a simplified example. A full-featured tool would generate more.
            Object.keys(pinAssignments).forEach(pin => {
                const func = pinAssignments[pin];
                if (func.startsWith('UART') || func.startsWith('SPI') || func.startsWith('I2C') || func.startsWith('CAN')) {
                    dtsContent += `
    fragment@1 {
        target = <&iomuxc>;
        __overlay__ {
            // Placeholder for peripheral fragment (e.g., UART2)
            // You may need to add more details here.
        };
    };
`;
                }
            });

            dtsContent += `
        };
    };
};`;
            
            return dtsContent;
        }

        // Event listener for the export button
        document.getElementById('export-dts-btn').addEventListener('click', () => {
            const dtsContent = generateDTS();
            const blob = new Blob([dtsContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'pocketbeagle2-config.dts';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            URL.revokeObjectURL(url);
        });

        // Initial render on page load
        document.addEventListener('DOMContentLoaded', () => {
            renderPins();
        });
    </script>
</body>
</html>
